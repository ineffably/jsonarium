{
  "type": "interface",
  "name": "BatchableElement",
  "sourcePath": "rendering/batcher/shared/Batcher.ts",
  "extends": [],
  "description": "The action types for a batch. / export type BatchAction = 'startBatch' | 'renderBatch'; /** A batch pool is used to store batches when they are not currently in use. / export class Batch implements Instruction { public renderPipeId = 'batch'; public action: BatchAction = 'startBatch'; // TODO - eventually this could be useful for flagging batches as dirty and then only rebuilding those ones // public elementStart = 0; // public elementSize = 0; // for drawing.. public start = 0; public size = 0; public textures: BatchTextureArray = new BatchTextureArray(); public blendMode: BLEND_MODES = 'normal'; public topology: Topology = 'triangle-strip'; public canBundle = true; /** breaking rules slightly here in the name of performance.. storing references to these bindgroups here is just faster for access! keeps a reference to the GPU bind group to set when rendering this batch for WebGPU. Will be null is using WebGL. / public gpuBindGroup: GPUBindGroup; /** breaking rules slightly here in the name of performance.. storing references to these bindgroups here is just faster for access! keeps a reference to the bind group to set when rendering this batch for WebGPU. Will be null if using WebGl. / public bindGroup: BindGroup; public batcher: Batcher; public destroy() { this.textures = null; this.gpuBindGroup = null; this.bindGroup = null; this.batcher = null; } } // inlined pool for SPEEEEEEEEEED :D const batchPool: Batch[] = []; let batchPoolIndex = 0; GlobalResourceRegistry.register({ clear: () => { // check if the first element has a destroy method if (batchPool.length > 0) { for (const item of batchPool) { if (item) item.destroy(); } } batchPool.length = 0; // clear the array batchPoolIndex = 0; }, }); function getBatchFromPool() { return batchPoolIndex > 0 ? batchPool[--batchPoolIndex] : new Batch(); } function returnBatchToPool(batch: Batch) { batchPool[batchPoolIndex++] = batch; } /** Represents an element that can be batched for rendering.",
  "category": "rendering",
  "deprecated": false,
  "properties": [
    {
      "name": "batcherName",
      "type": "string",
      "optional": false,
      "description": "The name of the batcher to use. Must be registered."
    },
    {
      "name": "texture",
      "type": "Texture",
      "optional": false,
      "description": "The texture to be used for rendering."
    },
    {
      "name": "blendMode",
      "type": "BLEND_MODES",
      "optional": false,
      "description": "The blend mode to be applied."
    },
    {
      "name": "indexSize",
      "type": "number",
      "optional": false,
      "description": "The size of the index data."
    },
    {
      "name": "attributeSize",
      "type": "number",
      "optional": false,
      "description": "The size of the attribute data."
    },
    {
      "name": "topology",
      "type": "Topology\n\n    /**\n     * Whether the element should be packed as a quad for better performance.\n     * @type {boolean}\n     */\n    packAsQuad: boolean",
      "optional": false,
      "description": "The topology to be used for rendering."
    },
    {
      "name": "_textureId",
      "type": "number",
      "optional": false,
      "description": "The texture ID, stored for efficient updating."
    },
    {
      "name": "_attributeStart",
      "type": "number",
      "optional": false,
      "description": "The starting position in the attribute buffer."
    },
    {
      "name": "_indexStart",
      "type": "number",
      "optional": false,
      "description": "The starting position in the index buffer."
    },
    {
      "name": "_batcher",
      "type": "Batcher",
      "optional": false,
      "description": "Reference to the batcher."
    },
    {
      "name": "_batch",
      "type": "Batch",
      "optional": false,
      "description": "Reference to the batch."
    },
    {
      "name": "packAsQuad",
      "type": "true",
      "optional": false,
      "description": "Represents a batchable quad element. / export interface BatchableQuadElement extends BatchableElement { /** Indicates that this element should be packed as a quad."
    },
    {
      "name": "attributeSize",
      "type": "4",
      "optional": false,
      "description": "The size of the attribute data for this quad element."
    },
    {
      "name": "indexSize",
      "type": "6",
      "optional": false,
      "description": "The size of the index data for this quad element."
    },
    {
      "name": "bounds",
      "type": "BoundsData",
      "optional": false,
      "description": "The bounds data for this quad element."
    },
    {
      "name": "uvs",
      "type": "number[] | Float32Array",
      "optional": false,
      "description": "Represents a batchable mesh element. / export interface BatchableMeshElement extends BatchableElement { /** The UV coordinates of the mesh."
    },
    {
      "name": "positions",
      "type": "number[] | Float32Array",
      "optional": false,
      "description": "The vertex positions of the mesh."
    },
    {
      "name": "indices",
      "type": "number[] | Uint16Array | Uint32Array",
      "optional": false,
      "description": "The indices of the mesh."
    },
    {
      "name": "indexOffset",
      "type": "number",
      "optional": false,
      "description": "The offset in the index buffer."
    },
    {
      "name": "attributeOffset",
      "type": "number",
      "optional": false,
      "description": "The offset in the attribute buffer."
    },
    {
      "name": "packAsQuad",
      "type": "false",
      "optional": false,
      "description": "Indicates that this element should not be packed as a quad."
    },
    {
      "name": "maxTextures",
      "type": "number",
      "optional": false,
      "description": "The options for the batcher. / export interface BatcherOptions { /** The maximum number of textures per batch."
    },
    {
      "name": "attributesInitialSize",
      "type": "number",
      "optional": true,
      "description": "The initial size of the attribute buffer."
    },
    {
      "name": "indicesInitialSize",
      "type": "number",
      "optional": true,
      "description": "The initial size of the index buffer."
    },
    {
      "name": "defaultOptions",
      "type": "Partial<BatcherOptions> = {\n        maxTextures: null,\n        attributesInitialSize: 4,\n        indicesInitialSize: 6,\n    }",
      "optional": false,
      "description": null
    },
    {
      "name": "uid",
      "type": "number = uid('batcher')",
      "optional": false,
      "description": null
    },
    {
      "name": "attributeBuffer",
      "type": "ViewableBuffer",
      "optional": false,
      "description": null
    },
    {
      "name": "indexBuffer",
      "type": "IndexBufferArray",
      "optional": false,
      "description": null
    },
    {
      "name": "attributeSize",
      "type": "number",
      "optional": false,
      "description": null
    },
    {
      "name": "indexSize",
      "type": "number",
      "optional": false,
      "description": null
    },
    {
      "name": "elementSize",
      "type": "number",
      "optional": false,
      "description": null
    },
    {
      "name": "elementStart",
      "type": "number",
      "optional": false,
      "description": null
    },
    {
      "name": "batches",
      "type": "Batch[] = []",
      "optional": false,
      "description": null
    },
    {
      "name": "_elements",
      "type": "BatchableElement[] = []",
      "optional": false,
      "description": null
    },
    {
      "name": "_batchIndexStart",
      "type": "number",
      "optional": false,
      "description": null
    },
    {
      "name": "_batchIndexSize",
      "type": "number",
      "optional": false,
      "description": null
    },
    {
      "name": "maxTextures",
      "type": "number",
      "optional": false,
      "description": null
    },
    {
      "name": "name",
      "type": "string",
      "optional": false,
      "description": null
    },
    {
      "name": "vertexSize",
      "type": "number",
      "optional": false,
      "description": null
    },
    {
      "name": "geometry",
      "type": "Geometry",
      "optional": false,
      "description": null
    },
    {
      "name": "shader",
      "type": "Shader",
      "optional": false,
      "description": null
    },
    {
      "name": "element",
      "type": "BatchableMeshElement,\n        float32View: Float32Array,\n        uint32View: Uint32Array,\n        index: number,\n        textureId: number\n    ): void",
      "optional": false,
      "description": null
    },
    {
      "name": "element",
      "type": "BatchableQuadElement,\n        float32View: Float32Array,\n        uint32View: Uint32Array,\n        index: number,\n        textureId: number\n    ): void",
      "optional": false,
      "description": null
    },
    {
      "name": "options",
      "type": "BatcherOptions)\n    {\n        options = { ...Batcher.defaultOptions, ...options }",
      "optional": false,
      "description": null
    },
    {
      "name": "batchableObject",
      "type": "BatchableElement)\n    {\n        this._elements[this.elementSize++] = batchableObject",
      "optional": false,
      "description": null
    },
    {
      "name": "batchableObject",
      "type": "BatchableElement, texture: Texture): boolean\n    {\n        const textureId = batchableObject._batch.textures.ids[texture._source.uid]",
      "optional": false,
      "description": null
    },
    {
      "name": "batchableObject",
      "type": "BatchableElement)\n    {\n        this.dirty = true",
      "optional": false,
      "description": null
    },
    {
      "name": "instructionSet",
      "type": "InstructionSet)\n    {\n        const elements = this._elements",
      "optional": false,
      "description": null
    },
    {
      "name": "action",
      "type": "BatchAction = 'startBatch'",
      "optional": false,
      "description": null
    },
    {
      "name": "batch",
      "type": "Batch,\n        indexStart: number,\n        indexSize: number,\n        textureBatch: BatchTextureArray,\n        blendMode: BLEND_MODES,\n        topology: Topology,\n        instructionSet: InstructionSet,\n        action: BatchAction\n    )\n    {\n        batch.gpuBindGroup = null",
      "optional": false,
      "description": null
    },
    {
      "name": "instructionSet",
      "type": "InstructionSet)\n    {\n        this.break(instructionSet)",
      "optional": false,
      "description": null
    },
    {
      "name": "size",
      "type": "number)\n    {\n        if (size * 4 <= this.attributeBuffer.size) return",
      "optional": false,
      "description": null
    },
    {
      "name": "size",
      "type": "number)\n    {\n        if (size <= this.indexBuffer.length) return",
      "optional": false,
      "description": null
    },
    {
      "name": "size",
      "type": "number)\n    {\n        const newSize = Math.max(size, this.attributeBuffer.size * 2)",
      "optional": false,
      "description": null
    },
    {
      "name": "size",
      "type": "number)\n    {\n        const indexBuffer = this.indexBuffer",
      "optional": false,
      "description": null
    },
    {
      "name": "indexBuffer",
      "type": "IndexBufferArray, index: number, indicesOffset: number)\n    {\n        indexBuffer[index] = indicesOffset + 0",
      "optional": false,
      "description": null
    },
    {
      "name": "element",
      "type": "BatchableMeshElement, indexBuffer: IndexBufferArray, index: number, indicesOffset: number)\n    {\n        const indices = element.indices",
      "optional": false,
      "description": null
    }
  ]
}